<!DOCTYPE html>
<html>
<head>
    <title>Real-time Attendance Monitor</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        #attendance-container { margin: 20px; }
        .attendance-item { 
            border: 1px solid #ddd; 
            padding: 10px; 
            margin-bottom: 10px; 
            border-radius: 5px;
        }
        .new-item { background-color: #eaffea; }
    </style>
</head>
<body>
    <h1>Real-time Attendance Monitor</h1>
    <div id="attendance-container"></div>

    <script>
        const socket = io();
        const container = document.getElementById('attendance-container');
        
        // Listen for real-time attendance records
        socket.on('attendance_record', (record) => {
            console.log('New attendance record:', record);
            
            const item = document.createElement('div');
            item.className = 'attendance-item new-item';
            item.innerHTML = `
                <strong>${record.userName || 'Unknown User'} (ID: ${record.userId})</strong><br>
                Time: ${new Date(record.timestamp).toLocaleString()}<br>
                Method: ${record.verificationMethod}<br>
                Type: ${record.punchType}
            `;
            
            // Add to top of container
            container.insertBefore(item, container.firstChild);
            
            // Remove highlight after 5 seconds
            setTimeout(() => {
                item.classList.remove('new-item');
            }, 5000);
            
            // Keep only the last 50 records
            if (container.children.length > 50) {
                container.removeChild(container.lastChild);
            }
        });
        
        // Listen for users data
        socket.on('users_data', (users) => {
            console.log('Received users:', users);
        });
    </script>
</body>
</html>